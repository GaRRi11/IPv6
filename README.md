# IPv6

1. IPv6 Address Structure & Rules
Basic Format

IPv6 has 8 blocks, each block has 4 digits which may contain alphabets and numbers.

Zero Compression Rules

Leading zeros in a block can be removed.
Example:
2001:0db8:85a3:0000:0000:8a2e:0370:7334 →
2001:db8:85a3:0:0:8a2e:370:7334

A full zero block can be replaced with ::

You can ONLY use :: one time in an address.

:: means “one or more blocks of zeros”.

Example:
2001:0db8:85a3:0000:0000:8a2e:0370:7334 →
2001:db8:85a3::8a2e:370:7334


5. Prefix Length

99% of IPv6 uses /64

First 64 bits = network prefix

Last 64 bits = Interface ID


2. IPv6 Address Types
   
2.1 Global Unicast Address (GUA)

IPv6 version of public WAN IP.

Starts with: 2000::/3
(Any address starting with 2xxx or 3xxx)

Example:
2a02:8440:715c:4cdf:c0a6:459f:0ddc:f5c1

First 4 blocks = provided by ISP

Last 4 blocks = Interface ID (Random blocks generated by device changed periodically) 

After connecting the network router will give prefix via RA which ISP uses then device will add
its own IID and craft full GUA IPv6.


2.2 Link-Local Address (LLA)

Automatically created by every IPv6 device.

Always Starts with fixed prefix fe80::/10

Last 4 blocks generated based on device mac, or just fixed stable blocks.

Used for:

Neighbor Discovery

Router Discovery

SLAAC

Local communication

Format: fe80:xxxx:xxxx:xxxx:…

2.3 Unique Local Address (ULA)

Used in LAN.

Like private IPv4.

Not automatic.

Always Starts with fixed Prefix: fc00::/7

Last 4 blocks are just fixed stable blocks.

Examples:
fd12:3456:789a::1
fd00:abcd::5
fd34:55aa:1::10

2.4 ULA vs LLA

| Scenario                          | Uses LLA? | Uses ULA?                                  |
| --------------------------------- | --------- | ------------------------------------------ |
| Talking to router                 | ✔ Yes     | ✖ No                                       |
| Finding neighbors                 | ✔ Yes     | ✖ No                                       |
| Local-only traffic                | ✔ Yes     | ✖ No                                       |
| Communication across LAN segments | ✖ No      | ✔ Yes                                      |
| Internal servers                  | ✖ No      | ✔ Yes                                      |


3. Duplicate Address Detection (DAD)

“Is anyone using the address? If yes, tell me your MAC.”

If no response then that IPv6 is free to use, and device asignes it to itself.


6. IPv6: No Broadcast

IPv6 uses multicast instead of broadcast.

Common multicast groups:

ff02::1 — all nodes

ff02::2 — all routers

ff02::1:ffXX:XXXX — solicited-node (used by NDP)

ff02::1:2 — DHCPv6 servers

IPv6 also supports anycast.

Example:
2001:db8:100::53

7. Neighbor Discovery Protocol (NDP)

NDP involves: NS-NA, RS-RS.

NS - what MAC does this IPv6 user have?

NA - response of NS (MAC)

RS - Discovering router in network.

RA - Response of RS: network prefix, SLAAC allowed or not, DHCPv6 needed or not, DNS(optional).

if SLAAC allowed: device dont need DHCPv6 to get GUA IPv6. device will craft address itself by adding routers provided prefix
and its own randomized IID, DAD check it and assigned to itself.

if SLAAC not allowed then DHCPv6 must be enabled so managed mode will handle IPv6 assignments to devies.

8. If Router Does Not Support IPv6

Works:

LLA

Does NOT work:

❌ GUA

❌ ULA

❌ DNS via IPv6

❌ Default gateway

No RA → no IPv6 routing.

10. DHCPv6

Optional (unlike IPv4).

| Feature            | SLAAC      | Stateful DHCPv6 | Stateless DHCPv6  |
| ------------------ | ---------- | --------------- | ----------------- |
| IPv6 address       | ✔ Yes      | ✔ Yes           | ✔ Yes (via SLAAC) |
| DNS                | ✔ Maybe    | ✔ Yes           | ✔ Yes             |
| Gateway            | ✔ Yes (RA) | ✔ Yes (RA)      | ✔ Yes (RA)        |
| Full admin control | ❌ No       | ✔ Yes           | ❌ No              |


DHCPv6 cannot give default gateway.

11. Default Gateway in IPv6

When device receives RS from router, routers LLA IPv6 is used as IPv6 gateway.

If RA missing → no IPv6 routing at all

12. IPv6 Packet Structure
Field	Purpose
Source	Who sent the packet
Destination	Who receives it
Hop Limit	Prevent infinite loops
Next Header	TCP/UDP/ICMPv6
Flow Label	Group packets from same flow

Simpler than IPv4 (no checksum, no fragmentation by routers).

13. IPv6 Multicast Groups Summary

ff02::1 — all devices

ff02::2 — all routers

ff02::1:ffXX:XXXX — solicited-node (for NS instead of ARP)
